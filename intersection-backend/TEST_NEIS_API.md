# NEIS API 테스트 가이드

## 문제 진단

자동완성이 작동하지 않을 때 다음을 확인하세요:

### 1. 백엔드 서버 로그 확인

백엔드 서버 콘솔에서 다음 로그를 확인하세요:

#### 정상적인 경우:
```
[학교 검색 요청 수신] 키워드: '산본'
[학교 검색 시작] 키워드: '산본', API 키 존재: True
[NEIS API 호출] 학교종류: 1, 키워드: '산본'
[NEIS API 응답] 학교종류: 1, 상태코드: 200
[NEIS API 응답 데이터] 학교종류: 1, 키: ['schoolInfo', 'RESULT']
[NEIS API] 학교종류: 1, 결과 개수: 3
[NEIS API] 학교종류: 1, 파싱된 학교명: ['산본초등학교', '산본북초등학교', ...]
[학교 검색 완료] 키워드: '산본', 결과: 3개
```

#### 문제가 있는 경우:

**케이스 1: API 키가 없는 경우**
```
[경고] NEIS_API_KEY가 설정되지 않았습니다.
```
→ `.env` 파일에 `NEIS_API_KEY=인증키` 추가 후 서버 재시작

**케이스 2: NEIS API 호출 실패**
```
[NEIS API 오류] 학교종류: 1, HTTP 401: ...
```
→ 인증키가 잘못되었거나 만료됨. https://open.neis.go.kr 에서 재발급

**케이스 3: 응답 구조가 다른 경우**
```
[NEIS API 응답 데이터] 학교종류: 1, 키: ['RESULT']
[NEIS API 응답] 학교종류: 1, CODE: INFO-200, MESSAGE: ...
```
→ NEIS API 응답 구조가 예상과 다름. 응답 본문을 확인하여 파싱 로직 수정 필요

**케이스 4: 요청이 도달하지 않는 경우**
→ 백엔드 로그에 아무것도 안 나옴
→ 백엔드 서버가 실행 중인지, 포트가 맞는지 확인

### 2. 프론트엔드 콘솔 확인

브라우저 개발자 도구 콘솔에서 다음을 확인:

#### 정상적인 경우:
```
학교 검색 요청: 산본
학교 검색 API URL: http://127.0.0.1:8000/common/search/schools?keyword=%EC%82%B0%EB%B3%B8
학교 검색 요청 키워드: 산본 (인코딩: %EC%82%B0%EB%B3%B8)
학교 검색 API 상태 코드: 200
학교 검색 API 응답 본문: ["산본초등학교","산본중학교","산본고등학교"]
파싱된 결과: [산본초등학교, 산본중학교, 산본고등학교] (3개)
학교 검색 결과: 3개
```

#### 문제가 있는 경우:

**케이스 1: 타임아웃**
```
학교 검색 오류: TimeoutException after 0:00:15.000000: Future not completed
```
→ 백엔드가 응답하지 않음. 백엔드 로그 확인

**케이스 2: 네트워크 오류**
```
학교 검색 오류: Failed host lookup: '127.0.0.1'
```
→ 백엔드 서버가 실행되지 않음

**케이스 3: 500 에러**
```
학교 검색 API 오류: 500, 응답: ...
```
→ 백엔드 내부 오류. 백엔드 로그 확인

### 3. 수동 테스트

터미널에서 직접 API 테스트:

```bash
# Windows PowerShell
curl http://127.0.0.1:8000/common/search/schools?keyword=산본

# 또는 브라우저에서 직접 접속
http://127.0.0.1:8000/common/search/schools?keyword=산본
```

정상 응답 예시:
```json
["산본초등학교","산본중학교","산본고등학교"]
```

## 해결 방법

1. **백엔드 서버 재시작**: `.env` 파일 수정 후 반드시 재시작
2. **인증키 확인**: https://open.neis.go.kr 에서 인증키가 유효한지 확인
3. **네트워크 확인**: 백엔드가 `http://127.0.0.1:8000`에서 실행 중인지 확인
4. **CORS 확인**: 프론트엔드와 백엔드가 같은 포트/도메인인지 확인

